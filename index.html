<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <script src="index.js"></script>
    <title>Typing</title>

</head>
<body>
    <div class="typed">|</div>
    <h class="accuracy"></h>
    <div id="output"></div>
    <section class="words-keyboard">
        <section class="typing-section">

            <div class="sentences-section">
                <div class="letters-section">
                    <p class="words">burundi is the great country in the world</p>
                </div>
            </div>
        </section>
    </section> 
</body>
<script>

    let typed = document.querySelector(".typed");
    let accuracy = document.querySelector(".accuracy");
    let score = 0;
    let typedLength = typed.textContent.length;

    let outputElement = document.getElementById("output");

    let letters = document.querySelector(".words").textContent.split('');
    let len = letters.length;

    document.onkeydown = (event) => {
    let pressedKey = event.key;
    
    typed.textContent += pressedKey;
    console.log("text is :" + typed.textContent);

    if(pressedKey == "Backspace"){
        let outputText = outputElement.textContent;
        //work on this part to improve the deleting
        outputElement.textContent = outputText.slice(0, outputText.length-1);
        letters[outputElement.textContent.length-2] = '<span style="color: white">' + letters[outputElement.textContent.length-2] + '</span>';
        console.log("deleting is :" + outputText + " " + outputText.length)
        // console.log("length is :" + outputElement.textContent.length)
    }else{
        outputElement.textContent += pressedKey;
    }

    let lastLetter = outputElement.textContent.slice(outputElement.textContent.length - 1);
    let letterPosition = outputElement.textContent.length;
    let currentLetter = letters[letterPosition-1];

    if(letterPosition <= len){
        if (currentLetter === lastLetter){
        // change the color
        letters[letterPosition-1] = '<span style="color: white">' + letters[letterPosition-1] + '</span>';
        document.querySelector(".words").innerHTML = letters.join("")
    }else{
        letters[letterPosition-1] = '<span style="color: red">' + letters[letterPosition-1] + '</span>';
        document.querySelector(".words").innerHTML = letters.join("")
    } 
    document.querySelector(".words").innerHTML = letters.join(""); // set the letter joined
    accuracy.textContent =score; //set the score of the correct typed letter
    };
}


</script>
</html>